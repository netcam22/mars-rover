(()=>{"use strict";var t=["rectangle","kite","circle"],n={E:0,N:90,W:180,S:270},e={L:90,R:-90,M:0};function r(t){var e=Object.keys(n).find((function(e){return n[e]===t}));return void 0!==e?e:""}function o(t){return t*Math.PI/180}function i(t){if(n.hasOwnProperty(t))return n[t]}function a(t){return t>=360?t%360:t<0?360+t%360:t}function u(t,u,c){return function(t,u,c){var d=t,l=u;return c.split("").map((function(t,u){var c=function(t,u,c){var d,l,s,f,v=(d=u,r(a(n[t]+e[d]))),y=i(v),p=(l=t,s=Math.round(Math.cos(o(n[l]))),f=Math.round(Math.sin(o(n[l]))),[-0===s?Math.abs(s):s,-0===f?Math.abs(f):f]),m=c,h=p[0],I=p[1],M=c[0],b=c[1],A=function(t){if(e.hasOwnProperty(t))return e[t]}(u),L=A&&0!==A?-1*A:0,P=[h+M,I+b];if(0===A)if(g(P))m=P;else{var R=i(t);v=r(a(R=R?R+180:180)),p=[0,0]}else p=[0,0];return{vector:p,rotate:L,direction:v,angle:y,coordinates:m}}(l,t,d);return l=void 0!==c.direction?c.direction:l,d=c.coordinates,{vector:c.vector,rotate:c.rotate,direction:l,angle:i(l),coordinates:d}}))}(t,u,c)}var c,d,l=(c={id:"",name:"",position:[],direction:""},{setId:function(t){return c.id=t},getId:function(){return c.id},setName:function(t){return c.name=t},getName:function(){return c.name},setPosition:function(t){return c.position=t},getPosition:function(){return c.position},setDirection:function(t){return c.direction=t},getDirection:function(){return c.direction}}),s=(d={id:0,name:"",style:"rectangle",size:[0,0],layout:[[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0]],occupied:void 0},{setId:function(t){return d.id=t},getId:function(){return d.id},setSize:function(t){return d.size=t},getSize:function(){return d.size},setStyle:function(t){return d.style=t},getStyle:function(){return d.style},setLayout:function(t){return d.layout=t},getLayout:function(){return d.layout},setOccupied:function(t,n){return function(t,n){var e=t[0],r=t[1];if(g([e,r])){var o=function(t,n,e){if(e||2===arguments.length)for(var r,o=0,i=n.length;o<i;o++)!r&&o in n||(r||(r=Array.prototype.slice.call(n,0,o)),r[o]=n[o]);return t.concat(r||Array.prototype.slice.call(n))}([],s.getLayout(),!0),i=o.length,a=[],u=a[0],c=a[1];if(n.length){var d=n[0],f=n[1];c=i-f-1,u=d}var v=i-r-1,y=e,p=o.map((function(t,e){return t.map((function(t,r){return e===v&&r===y?l.getId():n.length&&e===c&&r===u?0:t}))}));s.setLayout(p)}}(t,n)},isOccupied:function(t){return g(t)}});function f(n,e,r){var o;s.setId(e),s.setStyle(r),s.setSize((o=n,[parseInt(o[0]),parseInt(o[1])]));var i=function(n,e){var r,o,i=e[0],a=e[1];if(function(n){return t.includes(n)}(n)){if("rectangle"===n)return v([i,a]);if("kite"===n)return function(t){for(var n=2*t-1,e=new Array(n),r=0,o=0;o<n;o++)r=o<t?o+1:n-o,e[o]=new Array(r).fill(0);return e}(i);if("circle"===n)return o=v([2*(r=i)+1,2*r+1]).map((function(t,n){return t.map((function(t,e){return Math.pow(e-r,2)+Math.pow(n-r,2)<=Math.pow(r,2)?t:1}))})),o}return v([i,a])}(r,y(n));return s.setLayout(i)}function v(t){var n=t[0],e=t[1],r=new Array(n).fill(0);return new Array(e).fill(r)}function y(t){return[parseInt(t[0]),parseInt(t[1])]}function g(t){var n=t[0],e=t[1];if(n<0||e<0)return!1;var r=s.getLayout(),o=r.length;return e<o&&n<r[e].length&&(0===r[o-e-1][n]||r[o-e-1][n]===l.getId())}var p,m,h=(p={robotArray:[],plateauArray:[]},{addPlateau:function(t){return p.plateauArray.push(t)},getPlateauArray:function(){return p.plateauArray},addRobot:function(t){return p.robotArray.push(t)},updateCurrentRobot:function(t){return p.robotArray[p.robotArray.length-1]=t},getRobotArray:function(){return p.robotArray},emptyRobotArray:function(){return p.robotArray=[]}});function I(t,n){var e=function(t){return{position:y(t),direction:t[2]}}(n),r=e.position,o=e.direction,i=function(t,n,e,r){var o="".concat(n[0]).concat(t);if(l.setId(o),l.setName(n),l.setPosition(e),l.setDirection(r))return o}(h.getRobotArray().length,t,r,o),a={id:l.getId(),name:t,position:r,direction:o,move:void 0,destination:void 0,layout:s.getLayout(),journey:void 0};return h.addRobot(a),i}function M(t,n){return function(t,n){var e=function(t,n,e){if(g(t)){var r=u(t,n,e),o=r[r.length-1].coordinates,i=o[0],a=o[1],c=r[r.length-1].direction,d="".concat(i).concat(a).concat(c);return s.setOccupied([i,a],l.getPosition()),l.setPosition([i,a]),l.setDirection(c),{journey:r,destination:d}}return{journey:void 0,destination:void 0}}(l.getPosition(),l.getDirection(),t);if(e&&n===l.getId()){var r=e.journey,o=e.destination,i={id:n,name:l.getName(),position:l.getPosition(),direction:l.getDirection(),move:t,destination:o,layout:s.getLayout(),journey:r};return h.updateCurrentRobot(i),i}}(t,n)}var b={gridSize:"66",gridStyle:"rectangle",inputs:[["Fred","12N","LMLMLMLMM"],["Bob","33E","MMRMMRMRRM"]],moves:"animate"};function A(t,n,e){var r,o="";return t&&(null==t?void 0:t.destination)&&t.journey?(o+="Hello again, I am ".concat(t.name," and I have moved ").concat(t.move," and arrived at ").concat(t.destination),o+="I moved:",null===(r=t.journey)||void 0===r||r.forEach((function(t){var n=t.vector,e=t.rotate,r=t.direction,i=t.angle,a=t.coordinates;o+="Vector: ".concat(n,", Rotate: ").concat(e,", Direction: ").concat(r,", Angle: ").concat(i,", Coordinates: ").concat(a)}))):o+="Hello again, I am ".concat(n," and I was unable to make my journey as the start position ").concat(e," was not available."),o}var L=b.inputs.map((function(t){var n=t[0],e=t[1],r=t[2],o=function(t,n){return I(t,n)}(n,e);if(o)return"animate"===b.moves?A(M(r,o),n,e):r.split("").forEach((function(t){return A(M(t,o),n,e)}))}));null===(m=document.getElementById("robot-button"))||void 0===m||m.addEventListener("click",(function(){var t=document.getElementById("plateau-shape"),n=document.getElementById("plateau-size"),e=document.getElementById("plateau-data");if(e&&(e.innerHTML="".concat(t.value," ").concat(n.value)),t&&n){var r=function(t,n){if(t&&n)return function(t,n){h.emptyRobotArray();var e=h.getPlateauArray().length,r=f(t,e,n);return h.addPlateau({gridSize:t,plateau:r,style:n,id:e}),r}(t,n)}(n.value,t.value);r&&(console.log("layout",r),function(t){var n=document.getElementById("mission");console.log(n),n&&t.forEach((function(t,e){return t.map((function(t,r){var o=document.createElement("div");o.className="grid-item",o.id="".concat(e).concat(r),n.appendChild(o)}))}))}(r))}var o=document.getElementById("robot-data"),i=L||"no content found";i[0]&&(console.log(i[0]),o&&(o.innerHTML=i[0]))}))})();