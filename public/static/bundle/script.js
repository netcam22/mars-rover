(()=>{"use strict";var t=["rectangle","kite","circle"],n={E:0,N:90,W:180,S:270},e={L:90,R:-90,M:0};function r(t){var e=Object.keys(n).find((function(e){return n[e]===t}));return void 0!==e?e:""}function o(t){return t*Math.PI/180}function i(t){if(n.hasOwnProperty(t))return n[t]}function a(t){return t>=360?t%360:t<0?360+t%360:t}function c(t,c,u){return function(t,c,u){var d=t,s=c;return u.split("").map((function(t,c){var u=function(t,c,u){var d,s,l,f,v=(d=c,r(a(n[t]+e[d]))),y=i(v),p=(s=t,l=Math.round(Math.cos(o(n[s]))),f=Math.round(Math.sin(o(n[s]))),[-0===l?Math.abs(l):l,-0===f?Math.abs(f):f]),m=u,h=p[0],M=p[1],I=u[0],b=u[1],A=function(t){if(e.hasOwnProperty(t))return e[t]}(c),L=A&&0!==A?-1*A:0,E=[h+I,M+b];if(0===A)if(g(E))m=E;else{var w=i(t);v=r(a(w=w?w+180:180)),p=[0,0]}else p=[0,0];return{vector:p,rotate:L,direction:v,angle:y,coordinates:m}}(s,t,d);return s=void 0!==u.direction?u.direction:s,d=u.coordinates,{vector:u.vector,rotate:u.rotate,direction:s,angle:i(s),coordinates:d}}))}(t,c,u)}var u,d,s=(u={id:"",name:"",position:[],direction:""},{setId:function(t){return u.id=t},getId:function(){return u.id},setName:function(t){return u.name=t},getName:function(){return u.name},setPosition:function(t){return u.position=t},getPosition:function(){return u.position},setDirection:function(t){return u.direction=t},getDirection:function(){return u.direction}}),l=(d={id:0,name:"",style:"rectangle",size:[0,0],layout:[[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0]],occupied:void 0},{setId:function(t){return d.id=t},getId:function(){return d.id},setSize:function(t){return d.size=t},getSize:function(){return d.size},setStyle:function(t){return d.style=t},getStyle:function(){return d.style},setLayout:function(t){return d.layout=t},getLayout:function(){return d.layout},setOccupied:function(t,n){return function(t,n){var e=t[0],r=t[1];if(g([e,r])){var o=function(t,n,e){if(e||2===arguments.length)for(var r,o=0,i=n.length;o<i;o++)!r&&o in n||(r||(r=Array.prototype.slice.call(n,0,o)),r[o]=n[o]);return t.concat(r||Array.prototype.slice.call(n))}([],l.getLayout(),!0),i=o.length,a=[],c=a[0],u=a[1];if(n.length){var d=n[0],f=n[1];u=i-f-1,c=d}var v=i-r-1,y=e,p=o.map((function(t,e){return t.map((function(t,r){return e===v&&r===y?s.getId():n.length&&e===u&&r===c?0:t}))}));l.setLayout(p)}}(t,n)},isOccupied:function(t){return g(t)}});function f(n,e,r){var o;l.setId(e),l.setStyle(r),l.setSize((o=n,[parseInt(o[0]),parseInt(o[1])]));var i=function(n,e){var r,o,i=e[0],a=e[1];if(function(n){return t.includes(n)}(n)){if("rectangle"===n)return v([i,a]);if("kite"===n)return function(t){for(var n=2*t-1,e=new Array(n),r=0,o=0;o<n;o++)r=o<t?o+1:n-o,e[o]=new Array(r).fill(0);return e}(i);if("circle"===n)return o=v([2*(r=i)+1,2*r+1]).map((function(t,n){return t.map((function(t,e){return Math.pow(e-r,2)+Math.pow(n-r,2)<=Math.pow(r,2)?t:1}))})),o}return v([i,a])}(r,y(n));return l.setLayout(i)}function v(t){var n=t[0],e=t[1],r=new Array(n).fill(0);return new Array(e).fill(r)}function y(t){return[parseInt(t[0]),parseInt(t[1])]}function g(t){var n=t[0],e=t[1];if(n<0||e<0)return!1;var r=l.getLayout(),o=r.length;return e<o&&n<r[e].length&&(0===r[o-e-1][n]||r[o-e-1][n]===s.getId())}var p,m,h=(p={robotArray:[],plateauArray:[]},{addPlateau:function(t){return p.plateauArray.push(t)},getPlateauArray:function(){return p.plateauArray},addRobot:function(t){return p.robotArray.push(t)},updateCurrentRobot:function(t){return p.robotArray[p.robotArray.length-1]=t},getRobotArray:function(){return p.robotArray},emptyRobotArray:function(){return p.robotArray=[]}});function M(t,n){var e=function(t){return{position:y(t),direction:t[2]}}(n),r=e.position,o=e.direction,i=function(t,n,e,r){var o="".concat(n[0]).concat(t);if(s.setId(o),s.setName(n),s.setPosition(e),s.setDirection(r))return o}(h.getRobotArray().length,t,r,o),a={id:s.getId(),name:t,position:r,direction:o,move:void 0,destination:void 0,layout:l.getLayout(),journey:void 0};return h.addRobot(a),i}function I(t,n){return function(t,n){var e=function(t,n,e){if(g(t)){var r=c(t,n,e),o=r[r.length-1].coordinates,i=o[0],a=o[1],u=r[r.length-1].direction,d="".concat(i).concat(a).concat(u);return l.setOccupied([i,a],s.getPosition()),s.setPosition([i,a]),s.setDirection(u),{journey:r,destination:d}}return{journey:void 0,destination:void 0}}(s.getPosition(),s.getDirection(),t);if(e&&n===s.getId()){var r=e.journey,o=e.destination,i={id:n,name:s.getName(),position:s.getPosition(),direction:s.getDirection(),move:t,destination:o,layout:l.getLayout(),journey:r};return h.updateCurrentRobot(i),i}}(t,n)}function b(t,n,e){var r,o="";return t&&(null==t?void 0:t.destination)&&t.journey?(o+="Hello again, I am ".concat(t.name," and I have moved ").concat(t.move," and arrived at ").concat(t.destination),o+="I moved:",null===(r=t.journey)||void 0===r||r.forEach((function(t){var n=t.vector,e=t.rotate,r=t.direction,i=t.angle,a=t.coordinates;o+="Vector: ".concat(n,", Rotate: ").concat(e,", Direction: ").concat(r,", Angle: ").concat(i,", Coordinates: ").concat(a)}))):o+="Hello again, I am ".concat(n," and I was unable to make my journey as the start position ").concat(e," was not available."),o}null===(m=document.getElementById("robot-button"))||void 0===m||m.addEventListener("click",(function(){var t,n,e=document.getElementById("plateau-shape"),r=document.getElementById("plateau-size"),o=document.getElementById("plateau-data");if(o&&(o.innerHTML="".concat(e.value," ").concat(r.value)),e&&r){var i=function(t,n){if(t&&n)return function(t,n){h.emptyRobotArray();var e=h.getPlateauArray().length,r=f(t,e,n);return h.addPlateau({gridSize:t,plateau:r,style:n,id:e}),r}("".concat(t).concat(t),n)}(r.value,e.value);i&&(console.log("layout",i),t=e.value,(n=document.getElementById("my-planet"))&&(n.classList.remove("circle","rectangle","kite"),n.classList.add(t)),function(t){var n=document.getElementById("plateau-container");if(n){n.innerHTML="";var e=1,r=1;t.forEach((function(t,o,i){var a,c,u;a=e,c=r,u=Math.PI/180,e=Math.sin(42*u)*Math.sqrt(Math.pow(c,2)+Math.pow(a,2))/Math.sin(93*u),r=function(t){var n=Math.PI/180;return t*Math.sin(87*n)*Math.sin(45*n)/Math.sin(48*n)}(e);var d=document.createElement("div");d.className="grid-container",d.id="row_".concat(o,"}"),n.prepend(d);var s=t.map((function(t){return"auto"}));d.style.gridTemplateColumns=s.join(" "),t.forEach((function(t,n){if(1!==t){var a=document.createElement("div");a.className="grid-item",a.classList.add("grid-circle-faded"),a.id="robot_".concat(n,"_").concat(o),a.style.width="".concat(100*e/i.length,"%"),a.style.padding="".concat(100*r/i.length,"% 0 0 0"),d.appendChild(a)}}))}))}}(i),function(t){var n=A.inputs[0][1].split(""),e=n[0],r=n[1],o=document.getElementById("robot_".concat(parseInt(e),"_").concat(parseInt(r)));if(o){var i=document.createElement("img");i.className="grid-robot",i.id="coords_".concat(e,"_").concat(r),i.style.position="absolute",i.style.width="100%",i.style.padding="100% 0 0 0",o.prepend(i),o.classList.remove("grid-circle-faded")}}())}var a=document.getElementById("robot-data"),c=L||"no content found";c[0]&&(console.log(c[0]),a&&(a.innerHTML=c[0]))}));var A={gridSize:"66",gridStyle:"rectangle",inputs:[["Fred","12N","LMLMLMLMM"],["Bob","33E","MMRMMRMRRM"]],moves:"animate"},L=A.inputs.map((function(t){var n=t[0],e=t[1],r=t[2],o=function(t,n){return M(t,n)}(n,e);if(o)return"animate"===A.moves?b(I(r,o),n,e):r.split("").forEach((function(t){return b(I(t,o),n,e)}))}))})();